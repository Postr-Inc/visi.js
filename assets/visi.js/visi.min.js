class e{constructor(e){this.arr=e,this.subscribers=[],this.store={},this.totalSize=0,this.cache={}}map(t){const n=this.arr.map(t);return this.notifySubscribers("map",[t]),new e(n)}filter(t){const n=this.arr.filter(t);return this.notifySubscribers("filter",[t]),new e(n)}reduce(e,t){const n=this.arr.reduce(e,t);return this.notifySubscribers("reduce",[e,t]),n}subscribe(e){this.subscribers.push(e)}setStore(e,t){this.store[e]=t;const n=JSON.stringify(this.store).length;this.totalSize+=n,this.notifySubscribers("setStore",[e,t])}getStore(e){return this.notifySubscribers("getStore",[e]),this.store[e]}sort(t){const n=this.arr.slice().sort(t);return this.notifySubscribers("sort",[t]),new e(n)}reverse(){const t=this.arr.slice().reverse();return this.notifySubscribers("reverse",[]),new e(t)}find(e){return this.notifySubscribers("find",[e]),this.arr.find(e)}some(e){return this.notifySubscribers("some",[e]),this.arr.some(e)}every(e){return this.notifySubscribers("every",[e]),this.arr.every(e)}concat(...t){this.notifySubscribers("concat",t);const n=this.arr.concat(...t);return this.notifySubscribers(),new e(n)}slice(t,n){this.notifySubscribers("slice",[t,n]);const s=this.arr.slice(t,n);return this.notifySubscribers(),new e(s)}splice(e,t,...n){return this.notifySubscribers("splice",[e,t,...n]),this.arr.splice(e,t,...n),this.notifySubscribers(),this}push(...e){return this.notifySubscribers("push",e),this.arr.push(...e),this.notifySubscribers(),this}pop(){this.notifySubscribers("pop",[]);return this.arr.pop()}shift(){this.notifySubscribers("shift",[]);const e=this.arr.shift();return this.notifySubscribers(),e}unshift(...e){return this.notifySubscribers("unshift",e),this.arr.unshift(...e),this.notifySubscribers(),this}forEach(e){return this.notifySubscribers("forEach",[e]),this.arr.forEach(e),this}includes(e){return this.notifySubscribers("includes",[e]),this.arr.includes(e)}indexOf(e){return this.notifySubscribers("indexOf",[e]),this.arr.indexOf(e)}lastIndexOf(e){return this.notifySubscribers("lastIndexOf",[e]),this.arr.lastIndexOf(e)}join(e){return this.notifySubscribers("join",[e]),this.arr.join(e)}toString(){return this.notifySubscribers("toString",[]),this.arr.toString()}notifySubscribers(e,t){function n(e){return e<1024?`dataset is ${e} bytes`:e<1048576?`${(e/1024).toFixed(2)} KB`:e<1073741824?`${(e/1048576).toFixed(2)} MB`:`${(e/1073741824).toFixed(2)} GB`}const s=JSON.stringify(this.store).length;this.totalSize+=s,this.subscribers.forEach((s=>{s({functionName:e,arguments:t,size:n(this.totalSize)})}))}}class t{constructor(){this.cache={},this.subscribers=new Set,this.shards=0,this.shardsessions=[]}async query(e){const t=this.getCachedResult(e);if(t)return t;try{const t=await e();return this.cacheResult(e,Array.from(arguments),t),t}catch(e){throw console.error(`Error executing query: ${e}`),e}}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}getCacheSizePerNode(){const e={};return Object.entries(this.cache).forEach((([t,n])=>{let s=0;Object.values(n).forEach((e=>{s+=JSON.stringify(e).length})),e[t]=`${s} bytes`})),e}notifySubscribers(e,t,n){this.subscribers.forEach((s=>{s({functionName:e,arguments:t,result:n})}))}getCachedResult(e){try{const t=this.getCacheKey(e),n=this.cache[t];return n?n.expiry&&Date.now()>n.expiry?(this.evictCache(t),null):n.result:null}catch(e){throw console.error(`Error getting cached result: ${e.message}`),e}}cacheResult(e,t,n,s){const r=this.getCacheKey(e,t),o={result:n};if(s&&(o.expiry=Date.now()+s),this.cache[r]=o,this.cacheSizeLimit&&Object.keys(this.cache).length>this.cacheSizeLimit){const e=Object.values(this.cache).reduce(((e,t)=>e.expiry<t.expiry?e:t));this.evictCache(this.getCacheKey(e))}this.notifySubscribers(e,t,n)}getCacheKey(e,t){return e.toString()+JSON.stringify(t)}async queryParallel(e){return await Promise.all(e.map((e=>this.query(e))))}evictCache(e){delete this.cache[e]}async queryWithSharding(e,t){try{const n=Math.ceil(e.length/t),s=[];for(let r=0;r<t;r++){const t=r*n,o=t+n;s.push(e.slice(t,o))}this.shards=s;const r=(await Promise.all(s.map((e=>this.queryParallel(e))))).flat(),o=s.map((e=>({queries:e.map((e=>{const t=this.getCacheKey(e),n=this.cache[t];return{query:e.toString(),result:n?n.result:null}}))})));return console.log(o),this.shardsessions=o,r}catch(e){throw console.error(`Error executing query with sharding: ${e}`),e}}saveCache(e){try{e(this.cache)}catch(e){throw console.error(`Error saving cache: ${e.message}`),e}}saveShardSessions(e,t,n=null,s=null){const r=JSON.stringify(this.shardSessions),o=new Blob([r],{type:"application/json"});if("local"==t){const t=URL.createObjectURL(o),n=document.createElement("a");n.href=t,n.download=e,n.click()}else"server"==t?fetch(n,{method:"POST",body:o}).then((e=>{if(!e.ok)throw new Error("Error saving shard sessions");s&&s()})):"store"==t&&localStorage.setItem(e,r)}async reloadShards(){return(await Promise.all(this.shards.map((e=>this.queryParallel(e))))).flat()}}window.help={lib:{description:"Load a library",usage:'lib("@tailwind/daisyui")',libraries:{"@tailwind/daisyui":"https://daisyui.com/docs/installation","@tailwind/core":"https://tailwindcss.com/docs/installation","@tailwind/plugin":"https://tailwindcss.com/docs/installation#installing-additional-presets","@react-bootstrap":"https://react-bootstrap.github.io/getting-started/introduction","@mui/material":"https://material-ui.com/getting-started/installation/","@d3.js":"https://www.npmjs.com/package/d3","@chart.js":"https://www.chartjs.org/docs/latest/getting-started/installation.html","@three.js":"https://threejs.org/docs/index.html#manual/en/introduction/Installation","@mastercss":"https://mastercss.js.org/docs/installation",frameworls:{"@lit-js":"https://lit.dev/docs/getting-started/"}}}};window.vistore=class{constructor(e){this.store={},this.triggers={},this.subscribers={},this.dbName=e,this.db=null,this.openDatabase()}openDatabase(){const e=indexedDB.open(this.dbName);e.onupgradeneeded=e=>{this.db=e.target.result,this.createObjectStore()},e.onsuccess=e=>{this.db=e.target.result,this.retrieveData()},e.onerror=e=>{console.error("Error opening IndexedDB database:",e.target.error)}}createObjectStore(){this.db.createObjectStore("data",{keyPath:"key"}).transaction.oncomplete=()=>{console.log("IndexedDB object store created.")}}retrieveData(){const e=this.db.transaction(["data"],"readonly").objectStore("data").getAll();e.onsuccess=e=>{e.target.result.forEach((e=>{this.store[e.key]=e.value}))},e.onerror=e=>{console.error("Error retrieving data from IndexedDB:",e.target.error)}}saveData(){const e=this.db.transaction(["data"],"readwrite").objectStore("data");for(const t in this.store){e.put({key:t,value:this.store[t]}).onerror=e=>{console.error("Error saving data to IndexedDB:",e.target.error)}}}get(e){return this.store[e]}set(e,t){this.store[e]=t,this.triggers[e]&&this.triggers[e].forEach((e=>{e()})),this.saveData()}trigger(e){this.subscribers[e]&&this.subscribers[e].forEach((t=>{t(this.store[e])}))}subscribe(e,t){this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t)}unsubscribe(e,t){this.subscribers[e]&&(this.subscribers[e]=this.subscribers[e].filter((e=>e!==t)))}};const n={read:(e,t=!1)=>new Promise(((n,s)=>{if(t)import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((t=>{const r=localStorage.getItem(e);if(r){const t=new Uint8Array(JSON.parse(r)),s=pako.inflate(t),o=(new TextDecoder).decode(s);console.log(`Read file: ${e}`),n(o)}else console.error(`File not found: ${e}`),s()}));else{const t=localStorage.getItem(e);t?(console.log(`Read file: ${e}`),n(t)):(console.error(`File not found: ${e}`),s())}})),write:(e,t,s=!1)=>new Promise(((r,o)=>{const i=e.substring(0,e.lastIndexOf("/"));if(!n.exists(i))return console.error(`Directory does not exist: ${i}`),void o();s?import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=(new TextEncoder).encode(t),o=pako.gzip(s),i=JSON.stringify(Array.from(o));localStorage.setItem(e,i),localStorage.setItem(`__fs_watch_${e}`,Date.now()),console.log(`Write file: ${e}`),r()})):(localStorage.setItem(e,t),localStorage.setItem(`__fs_watch_${e}`,Date.now()),console.log(`Write file: ${e}`),r())})),exists:e=>null!==localStorage.getItem(e),mkdir:e=>{if(n.exists(e))return void console.error(`Directory already exists: ${e}`);const t=e.split("/").filter((e=>""!==e));let s="/root";t.forEach((e=>{s+=`/${e}`,n.exists(s)||(localStorage.setItem(s,"{}"),console.log(`Created directory: ${s}`))}))},watch:(e,t)=>{let n=localStorage.getItem(`__fs_watch_${e}`);setInterval((()=>{const s=localStorage.getItem(`__fs_watch_${e}`);s!==n&&(n=s,t({event:"change",path:e}))}),1e3)},rmrf:e=>{const t=e.substring(0,e.lastIndexOf("/"));if(!n.exists(t))return void console.error(`Directory does not exist: ${t}`);const s=e.split("/").filter((e=>""!==e));let r="/root";s.forEach((e=>{r+=`/${e}`,n.exists(r)&&(localStorage.removeItem(r),console.log(`Removed directory: ${r}`))}))},ls:e=>{const t=e.substring(0,e.lastIndexOf("/"));if(!n.exists(t))return void console.error(`Directory does not exist: ${t}`);const s=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n.startsWith(e)&&s.push(n)}return s},cp:(e,t)=>{if(!n.exists(e))return void console.error(`File does not exist: ${e}`);const s=localStorage.getItem(e);localStorage.setItem(t,s),console.log(`Copied file: ${e} -> ${t}`)},mv:(e,t)=>{if(!n.exists(e))return void console.error(`File does not exist: ${e}`);const s=localStorage.getItem(e);localStorage.setItem(t,s),localStorage.removeItem(e),console.log(`Moved file: ${e} -> ${t}`)},cat:e=>{if(n.exists(e))return localStorage.getItem(e);console.error(`File does not exist: ${e}`)},pwd:()=>"/root",cd:e=>{n.exists(e)?localStorage.setItem("current_directory",e):console.error(`Directory does not exist: ${e}`)},clear:()=>{localStorage.clear()},size:e=>{if(!n.exists(e))return void console.error(`File does not exist: ${e}`);let t=localStorage.getItem(e).length,s=0;for(;t>1024;)t/=1024,s++;return`${t.toFixed(2)} ${["B","KB","MB","GB","TB"][s]}`},rename:(e,t)=>{if(!n.exists(e))return void console.error(`File does not exist: ${e}`);const s=localStorage.getItem(e);localStorage.setItem(t,s),localStorage.removeItem(e),console.log(`Renamed file: ${e} -> ${t}`)},help:()=>"Available commands: ls, pwd, cd, cat, mkdir, rmrf, cp, mv, clear, help, watch, write, read, rename, exists"};window.fs=n;const s={cpus:()=>navigator.hardwareConcurrency,hostname:()=>navigator.connection,platform:()=>{let e=navigator.userAgent;return e.includes("Win")?"Windows":e.includes("Mac")?"MacOS":e.includes("Linux")?"Linux":"Unknown"},hardware:async()=>{const e=await navigator.gpu.requestAdapter();let t=navigator.deviceMemory,n=0;for(;t>1024;)t/=1024,n++;return t=`${t.toFixed(2)} ${["B","KB","MB","GB","TB"][n]}`,{gpu:await e.requestDevice(),cpu:navigator.hardwareConcurrency+" Cores",ram:t}},arch:()=>"x64"};window.os=s;const r={};let o={newContainer:e=>{if(r[e])return void console.error(`Container with ID '${e}' already exists.`);const t=new Worker(URL.createObjectURL(new Blob([`\n    // Worker code\n    self.onmessage = (event) => {\n      const { event: eventType, id, code, callbackId } = event.data;\n      const container = ${JSON.stringify(r[e])};\n      \n      if (eventType === 'run') {\n        try {\n          // Execute the code within the container\n          const result = eval(code);\n          self.postMessage(JSON.stringify({ result, callbackId }));\n        } catch (error) {\n          self.postMessage(JSON.stringify({ error: error.message, callbackId }));\n        }\n      } else if (eventType === 'postMessage') {\n        // Handle custom messages sent from the main thread\n        container.onMessage(event.data.message);\n      } else if (eventType === 'exit') {\n        // Clean up the container\n         ${JSON.stringify(r[e])} = null;\n         console.log("Container with ID '${e}' exited.");\n        self.close();\n        delete containers[id];\n      }\n    };\n  `]))),n={id:e,worker:t,onMessage:()=>{},onDestroy:()=>{}};t.onmessage=s=>{const{result:r,error:o,callbackId:i}=JSON.parse(s.data);if(o){t.postMessage({event:"exit",id:e});const s=n.callbacks[i];s&&(delete n.callbacks[i],s(o))}else{const e=n.callbacks[i];e&&(delete n.callbacks[i],e(null,r))}},n.callbacks={},r[e]=n},run:(e,t,n)=>{const s=r[e];if(!s)return void console.error(`Container with ID '${e}' does not exist.`);const o=Math.random().toString(36).substring(7);s.callbacks[o]=n,s.worker.postMessage({event:"run",id:e,code:t,callbackId:o})},postMessage:(e,t)=>{const n=r[e];n?n.worker.postMessage({event:"postMessage",id:e,message:t}):console.error(`Container with ID '${e}' does not exist.`)},exit:e=>{const t=r[e];t?t.worker.postMessage({event:"exit",id:e}):console.error(`Container with ID '${e}' does not exist.`)},onMessage:(e,t)=>{const n=r[e];n?n.onMessage=t:console.error(`Container with ID '${e}' does not exist.`)},onDestroy:(e,t)=>{r[e]||console.error(`Container with ID '${e}' does not exist.`)}};window.contained=o,window.lib=e=>{if(!e)throw new Error("lib() must be called with a path!");if(e.startsWith("@tailwind/daisyui")){e=(e=e.replace("@tailwind/daisyui","")).replace("/",",");let t=document.createElement("link");t.rel="preload",t.as="script",t.href=`https://cdn.tailwindcss.com?plugins=${e}`,document.head.appendChild(t);let n=document.createElement("link");n.rel="preload",document.body.style.visibility="hidden",n.as="style",n.href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css",document.head.appendChild(n);let s=document.createElement("script");s.src=`https://cdn.tailwindcss.com?plugins=${e}`,s.id="tailwindcss",document.head.appendChild(s);let r=document.createElement("link");r.rel="stylesheet",r.href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css",document.head.appendChild(r),document.getElementById("tailwindcss")||document.head.appendChild(s),s.onload=()=>{document.head.removeChild(s),console.log(`Tailwind CSS & Daisy Ui loaded with plugins ${e}`),document.body.style.visibility="visible"}}if(e.startsWith("@tailwind/core")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://cdn.tailwindcss.com",document.head.appendChild(e),document.body.style.visibility="hidden";let t=document.createElement("script");t.src="https://cdn.tailwindcss.com",t.id="tailwindcss",document.getElementById("tailwindcss")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("Tailwind CSS loaded "),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}if(e.startsWith("@tailwind")){e=(e=e.replace("@tailwind/","")).replace("/",",");let t=document.createElement("link");t.rel="preload",t.as="script",t.href=`https://cdn.tailwindcss.com?plugins=${e}`,document.head.appendChild(t),document.body.style.visibility="hidden";let n=document.createElement("script");n.src=`https://cdn.tailwindcss.com?plugins=${e}`,n.id="tailwindcss",document.getElementById("tailwindcss")||document.head.appendChild(n),n.onload=()=>{document.head.removeChild(n),console.log(`Tailwind CSS loaded with plugins ${e}`),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}if(e.startsWith("@react-bootstrap")){let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js",e.id="react-bootstrap";let t=document.createElement("link");t.href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css",t.rel="stylesheet",t.integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65",t.crossOrigin="anonymous",document.body.style.visibility="hidden";const n=document.createElement("link");return n.rel="preload",n.as="script",document.body.style.visibility="hidden",document.getElementById("react-bootstrap")||(document.head.appendChild(e),document.head.appendChild(t)),void(e.onload=()=>{console.log("React BootStrap loaded"),document.head.removeChild(e),setTimeout((()=>{document.body.style.visibility="visible"}),100)})}if(e.startsWith("@d3.js")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://d3js.org/d3.v7.min.js",document.head.appendChild(e);let t=document.createElement("script");return t.src="https://d3js.org/d3.v7.min.js",t.id="d3.js",document.getElementById("d3.js")||document.head.appendChild(t),void(t.onload=()=>{document.head.removeChild(t),console.log("D3.js loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)})}if(e.startsWith("@chart.js")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(e);let t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/chart.js",t.id="chart.js",document.getElementById("chart.js")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("Chart.js loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}if(e.startsWith("@three.js")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://cdn.jsdelivr.net/npm/three",document.head.appendChild(e);let t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/three",t.id="three.js",document.getElementById("three.js")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("Three.js loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}if(e.startsWith("@mastercss")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://cdn.master.co/css";let t=document.createElement("link");t.href="https://cdn.master.co/normal.css",t.rel="preload",t.as="style",document.head.appendChild(t);let n=document.createElement("link");n.href="https://cdn.master.co/normal.css",n.rel="stylesheet",document.head.appendChild(n),document.head.appendChild(e),document.body.style.visibility="hidden";let s=document.createElement("script");return s.defer=!0,s.src="https://cdn.master.co/css",s.id="mastercss",document.getElementById("mastercss")||document.head.appendChild(s),void(s.onload=()=>{document.head.removeChild(s),console.log("Master CSS loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)})}if(e.startsWith("@mui/material"))if(mui=!0,1==muiprod){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://unpkg.com/@mui/material/umd/material-ui.production.min.js",document.head.appendChild(e);let t=document.createElement("script");t.src="https://unpkg.com/@mui/material/umd/material-ui.production.min.js",t.id="mui",document.getElementById("mui")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("MUI production loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}else{let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://unpkg.com/@mui/material@latest/umd/material-ui.development.js",document.head.appendChild(e);let t=document.createElement("script");t.src="https://unpkg.com/@mui/material@latest/umd/material-ui.development.js",t.id="mui",document.getElementById("mui")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("MUI dev loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}if(e.startsWith("@lit-js")){let e=document.createElement("link");e.rel="preload",e.as="script",e.href="https://cdn.jsdelivr.net/gh/lit/dist@2/core/lit-core.min.js",document.head.appendChild(e);let t=document.createElement("script");t.src="https://cdn.jsdelivr.net/gh/lit/dist@2/core/lit-core.min.js",t.id="lit-js",t.type="module",t.defer=!0,document.body.style.visibility="hidden",document.getElementById("lit-js")||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log("Lit JS loaded"),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}else{if(e.endsWith(".css")){if(a[e]){let t=a[e];i+=t.length;const n=new CSSStyleSheet;n.replaceSync(t),document.body.style.visibility="hidden",document.adoptedStyleSheets=[...document.adoptedStyleSheets,n],document.onload=()=>{document.body.style.visibility="visible"}}else fetch(e).then((t=>{t.text().then((t=>{a[e]=t,i+=t.length;const n=new CSSStyleSheet;n.replaceSync(t),document.body.style.visibility="hidden",document.adoptedStyleSheets=[...document.adoptedStyleSheets,n]}))}));return}if(e.endsWith(".js")){let t=document.createElement("script");t.src=e,t.type="module",t.id=e,document.body.style.visibility="hidden",document.getElementById(e)||document.head.appendChild(t),t.onload=()=>{document.head.removeChild(t),console.log(`${e} loaded`),setTimeout((()=>{document.body.style.visibility="visible"}),100)}}}};export default{Lazy:e,JsonHandler:t};window.Lazy=e,window.JsonHandler=t;export class ReactRouter{constructor(){this.routes={},this.currentUrl="",this.store={},this.rootElement=null,this.hashChangeListener=null,this.listeners={},this.storedroutes=[],this.errorcheck=null}get(e,t){const n=[],s=[],r=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(s.push(e.substring(1)),"([^/]+)"):e)).join("/"),o=new RegExp("^"+r+"(\\?(.*))?$");if(window.location.hash.substring(1).match(o)){this.storedroutes.push(window.location.hash.substring(1)),this.routes[e]=!0;const s=window.location.hash.substring(1).match(o),r={};for(let e=0;e<n.length;e++)para.ms[n[e]]=s[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return console.error("Cannot use query params with path params",e,window.location.hash.substring(1).split("?")[1]),!1;const i={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");i[n[0]]=n[1]}}const d={params:r,query:i,url:window.location.hash.substring(1),method:"GET"};let l=!1;const c={json:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=`<pre>${JSON.stringify(e)}</pre>`;document.getElementById(this.rootElement).innerHTML=t,l=!0}catch(e){throw new Error("Invalid JSON data")}},setCookie:(e,t,n)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let s=`${e}=${t};`;n&&(n.path&&(s+=`path=${n.path};`),n.domain&&(s+=`domain=${n.domain};`),n.maxAge&&(s+=`max-age=${n.maxAge};`),n.httpOnly&&(s+=`httpOnly=${n.httpOnly};`),n.secure&&(s+=`secure=${n.secure};`),n.sameSite&&(s+=`sameSite=${n.sameSite};`)),document.cookie=s},getCookie:e=>{const t=document.cookie.split(";");for(let n=0;n<t.length;n++){const s=t[n].trim(),r=s.split("=")[0];if(r===e){const e=s.split("=")[1];s.split(";").slice(1).map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{[t]:n}})).reduce(((e,t)=>Object.assign(e,t)),{});return{name:r,value:e}}}return null},title:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,l=!0},saveState:()=>{if(l)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.sessionStorage.setItem(e,e),l=!0},restoreState:()=>{if(l)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.location.hash=this.currentUrl,l=!0},send:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(this.rootElement).innerHTML=e,l=!0},jsx:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.React._render(e)(this.rootElement),l=!0},compress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{console.log("pako loaded");const s=(new TextEncoder).encode(e),r=pako.gzip(s);t(r)}))})),decompress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=new Uint8Array(e),r=pako.inflate(s),o=(new TextDecoder).decode(r);t(o)}))})),ip:()=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");return l=!0,fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((e=>e.ip))},return:()=>{l&&(l=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),l=!0},redirect:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,l=!0},compress:async e=>{const t=(new TextEncoder).encode(e);return pako.gzip(t)},decompress:async e=>{const t=new Uint8Array(e),n=pako.inflate(t);return(new TextDecoder).decode(n)},markdown:(e,t=null)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");"path"==t?fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=marked.parse(e)})):document.getElementById(this.rootElement).innerHTML=marked.parse(e)},sendFile:e=>{let t=this.rootElement;if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).innerHTML=`<img src="${e}" />`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n                        <img src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n                        <embed src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let s=document.createElement("a");s.href=window.URL.createObjectURL(n.response),s.download=e,s.click()},n.send()}};return this.hashChangeListener||(this.hashChangeListener=()=>{if(window.location.hash.substring(1).match(o)){const e=window.location.hash.substring(1).match(o),s={};for(let t=0;t<n.length;t++)s[n[t]]=e[t+1];const r={params:s,rootUrl:this.currentUrl,url:window.location.hash.substring(1)};t(r,{json:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=`<pre>${JSON.stringify(e)}</pre>`;document.getElementById(this.rootElement).innerHTML=t,l=!0}catch(e){throw new Error("Invalid JSON data")}},setCookie:(e,t,n)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let s=`${e}=${t};`;n&&(n.path&&(s+=`path=${n.path};`),n.domain&&(s+=`domain=${n.domain};`),n.maxAge&&(s+=`max-age=${n.maxAge};`),n.httpOnly&&(s+=`httpOnly=${n.httpOnly};`),n.secure&&(s+=`secure=${n.secure};`),n.sameSite&&(s+=`sameSite=${n.sameSite};`)),document.cookie=s},ip:()=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");return l=!0,fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((e=>e.ip))},getCookie:e=>{const t=document.cookie.split(";");for(let n=0;n<t.length;n++){const s=t[n].trim(),r=s.split("=")[0];if(r===e){const e=s.split("=")[1];s.split(";").slice(1).map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{[t]:n}})).reduce(((e,t)=>Object.assign(e,t)),{});return{name:r,value:e}}}return null},title:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,l=!0},saveState:()=>{if(l)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.sessionStorage.setItem(e,e),l=!0},restoreState:()=>{if(l)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.location.hash=this.currentUrl,l=!0},send:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(this.rootElement).innerHTML=e,l=!0},jsx:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.React._render(e)(this.rootElement),l=!0},return:()=>{l&&(l=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),l=!0},compress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{console.log("pako loaded");const s=(new TextEncoder).encode(e),r=pako.gzip(s);t(r)}))})),decompress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=new Uint8Array(e),r=pako.inflate(s),o=(new TextDecoder).decode(r);t(o)}))})),redirect:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,l=!0},markdown:(e,t=null)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");import("https://cdn.jsdelivr.net/npm/marked/marked.min.js").then((n=>{"path"==t?fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=marked.parse(e)})):document.getElementById(this.rootElement).innerHTML=marked.parse(e)}))},sendFile:e=>{let t=this.rootElement;if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).innerHTML=`<img src="${e}" />`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n                        <img src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n                        <embed src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let s=document.createElement("a");s.href=window.URL.createObjectURL(n.response),s.download=e,s.click()},n.send()}})}},window.addEventListener("hashchange",this.hashChangeListener)),t(d,c),!0}return console.log("Router is already initialized"),!1}error(e){let t=!1;window.onhashchange=()=>{if(!this.storedroutes.includes(window.location.hash.substring(1))){e({sendStatus:(e,n)=>{if(t)throw new Error("Cannot send file after headers have already been sent");if("number"!=typeof n)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:n}),t=!0},send:e=>{if(t)throw new Error("Cannot send file after headers have already been sent");document.getElementById(this.rootElement).innerHTML=e,t=!0},jsx:e=>{if(t)throw new Error("Cannot send file after headers have already been sent");window.React._render(e)(this.rootElement),t=!0},sendFile:e=>{if(t)throw new Error("Cannot send file after headers have already been sent");if(!e.endsWith(".html"))throw new Error("Cannot send file that is not html");fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=e})),t=!0},return:()=>{t&&(t=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))}})}},this.storedroutes.includes(window.location.hash.substring(1))||e()}root(e,t){const n=[],s=[],r=window.location.hash.substring(1);this.storedroutes.forEach((t=>{t==r?this.routes[t]=this.errorcheck=null:window.location.hash=e}));const o=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(s.push(e.substring(1)),"([^/]+)"):e)).join("/"),i=new RegExp("^"+o+"(\\?(.*))?$");if(this.routes[e]=!0,this.currentUrl=e,window.location.hash.substring(1).match(i)){const s=window.location.hash.substring(1).match(i),r={};for(let e=0;e<n.length;e++)r[n[e]]=s[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return console.error("Cannot use query params with path params",e,window.location.hash.substring(1).split("?")[1]),!1;const o={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");o[n[0]]=n[1]}}const d={params:r,query:o,url:window.location.hash.substring(1),method:"ROOT_GET"};let l=!1;const c={json:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=`<pre>${JSON.stringify(e)}</pre>`;document.getElementById(this.rootElement).innerHTML=t,l=!0}catch(e){throw new Error("Invalid JSON data")}},setCookie:(e,t,n)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let s=`${e}=${t};`;n&&(n.path&&(s+=`path=${n.path};`),n.domain&&(s+=`domain=${n.domain};`),n.maxAge&&(s+=`max-age=${n.maxAge};`),n.httpOnly&&(s+=`httpOnly=${n.httpOnly};`),n.secure&&(s+=`secure=${n.secure};`),n.sameSite&&(s+=`sameSite=${n.sameSite};`)),document.cookie=s},getCookie:e=>{const t=document.cookie.split(";");for(let n=0;n<t.length;n++){const s=t[n].trim(),r=s.split("=")[0];if(r===e){const e=s.split("=")[1];s.split(";").slice(1).map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{[t]:n}})).reduce(((e,t)=>Object.assign(e,t)),{});return{name:r,value:e}}}return null},title:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,l=!0},saveState:()=>{if(l)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);console.log(e),window.sessionStorage.getItem(e)?(window.location.hash=window.sessionStorage.getItem(e),console.log(window.sessionStorage.getItem(e))):(window.sessionStorage.setItem(e,e),console.log(window.sessionStorage.getItem(e))),l=!0},ip:()=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");return l=!0,fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((e=>e.ip))},restoreState:()=>{if(l)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?(window.location.hash=window.sessionStorage.getItem(e),console.log("restoring route",window.sessionStorage.getItem(e))):(window.location.hash=this.currentUrl,console.log("no route found")),l=!0},send:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(this.rootElement).innerHTML=e,l=!0},jsx:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.React._render(e)(this.rootElement),l=!0},return:()=>{l&&(l=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),l=!0},markdown:(e,t=null)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");import("https://cdn.jsdelivr.net/npm/marked/marked.min.js").then((n=>{"path"==t?fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=marked.parse(e)})):document.getElementById(this.rootElement).innerHTML=marked.parse(e)}))},redirect:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,l=!0},compress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{console.log("pako loaded");const s=(new TextEncoder).encode(e),r=pako.gzip(s);t(r)}))})),decompress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=new Uint8Array(e),r=pako.inflate(s),o=(new TextDecoder).decode(r);t(o)}))})),sendFile:e=>{let t=this.rootElement;if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).innerHTML=`<img src="${e}" />`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n                        <img src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n                        <embed src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let s=document.createElement("a");s.href=window.URL.createObjectURL(n.response),s.download=e,s.click()},n.send()}};return this.hashChangeListener||(this.hashChangeListener=()=>{if(window.location.hash.substring(1).match(i)){const e=window.location.hash.substring(1).match(i),s={};for(let t=0;t<n.length;t++)s[n[t]]=e[t+1];const r={params:s,rootUrl:this.currentUrl,url:window.location.hash.substring(1)};t(r,{json:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=`<pre>${JSON.stringify(e)}</pre>`;document.getElementById(this.rootElement).innerHTML=t,l=!0}catch(e){throw new Error("Invalid JSON data")}},title:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,l=!0},saveState:()=>{if(l)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.sessionStorage.setItem(e,e),l=!0},compress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{console.log("pako loaded");const s=(new TextEncoder).encode(e),r=pako.gzip(s);t(r)}))})),decompress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=new Uint8Array(e),r=pako.inflate(s),o=(new TextDecoder).decode(r);t(o)}))})),markdown:(e,t=null)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");import("https://cdn.jsdelivr.net/npm/marked/marked.min.js").then((n=>{"path"==t?fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=marked.parse(e)})):document.getElementById(this.rootElement).innerHTML=marked.parse(e)}))},restoreState:()=>{if(l)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.location.hash=this.currentUrl,l=!0},send:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(this.rootElement).innerHTML=e,l=!0},jsx:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.React._render(e)(this.rootElement),l=!0},return:()=>{l&&(l=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),l=!0},redirect:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,l=!0},sendFile:e=>{let t=this.rootElement;if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).innerHTML=`<img src="${e}" />`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n                        <img src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n                        <embed src="${e}" \n                        \n                        style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                         \n                        />\n                        `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let s=document.createElement("a");s.href=window.URL.createObjectURL(n.response),s.download=e,s.click()},n.send(),l=!0}})}},window.addEventListener("hashchange",this.hashChangeListener)),t(d,c),!0}return!1}post(e,t){if(!this.routes[e])throw new Error(`No listener registered for route ${e}`);const n={path:e,data:t};window.postMessage(n,"*")}listen(e,t){if(this.listeners[e])throw new Error(`Listener already registered for route ${e}`);const n=n=>{const s=n.data,r=s.path,o=s.data;r===e&&t(o)};window.addEventListener("message",n),this.listeners[e]=n}stopListening(e){const t=this.listeners[e];t&&(window.removeEventListener("message",t),delete this.listeners[e])}use(e){const t=[],n=[],s=e.split("/").map((e=>e.startsWith(":")?(t.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(t.push(e.substring(1)),"(.*)"):e.startsWith("?")?(n.push(e.substring(1)),"([^/]+)"):e)).join("/");new RegExp("^"+s+"(\\?(.*))?$");e=s,this.routes[e]=!0,this.storedroutes.push(e)}bindRoot(e){this.rootElement=e}onload(e){window.onload=()=>{window.addEventListener("DOMContentLoaded",e())}}on(e,t){window.addEventListener("hashchange",(()=>{const n=[],s=[],r=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(s.push(e.substring(1)),"([^/]+)"):e)).join("/"),o=new RegExp("^"+r+"(\\?(.*))?$");if(this.routes[e]=!0,this.currentUrl=e,window.location.hash.substring(1).match(o)){this.storedroutes.push(window.location.hash.substring(1)),this.routes[e]=!0;const s=window.location.hash.substring(1).match(o),r={};for(let e=0;e<n.length;e++)r[n[e]]=s[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return console.error("Cannot use query params with path params",e,window.location.hash.substring(1).split("?")[1]),!1;const i={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");i[n[0]]=n[1]}}const d={params:r,query:i,url:window.location.hash.substring(1),method:"POST"};let l=!1;t(d,{json:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=`<pre>${JSON.stringify(e)}</pre>`;document.getElementById(this.rootElement).innerHTML=t,l=!0}catch(e){throw new Error("Invalid JSON data")}},title:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,l=!0},setCookie:(e,t,n)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let s=`${e}=${t};`;n&&(n.path&&(s+=`path=${n.path};`),n.domain&&(s+=`domain=${n.domain};`),n.maxAge&&(s+=`max-age=${n.maxAge};`),n.httpOnly&&(s+=`httpOnly=${n.httpOnly};`),n.secure&&(s+=`secure=${n.secure};`),n.sameSite&&(s+=`sameSite=${n.sameSite};`)),document.cookie=s},getCookie:e=>{const t=document.cookie.split(";");for(let n=0;n<t.length;n++){const s=t[n].trim(),r=s.split("=")[0];if(r===e){const e=s.split("=")[1];s.split(";").slice(1).map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{[t]:n}})).reduce(((e,t)=>Object.assign(e,t)),{});return{name:r,value:e}}}return null},saveState:()=>{if(l)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.sessionStorage.setItem(e,e),l=!0},restoreState:()=>{if(l)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.location.hash=this.currentUrl,l=!0},send:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(this.rootElement).innerHTML=e,l=!0},jsx:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.React._render(e)(this.rootElement),l=!0},return:()=>{l&&(l=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),l=!0},ip:()=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");return l=!0,fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((e=>e.ip))},redirect:e=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,l=!0},compress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{console.log("pako loaded");const s=(new TextEncoder).encode(e),r=pako.gzip(s);t(r)}))})),decompress:async e=>new Promise(((t,n)=>{import("https://unpkg.com/pako@2.1.0/dist/pako.min.js").then((n=>{const s=new Uint8Array(e),r=pako.inflate(s),o=(new TextDecoder).decode(r);t(o)}))})),markdown:(e,t=null)=>{if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");import("https://cdn.jsdelivr.net/npm/marked/marked.min.js").then((n=>{"path"==t?fetch(e).then((e=>e.text())).then((e=>{document.getElementById(this.rootElement).innerHTML=marked.parse(e)})):document.getElementById(this.rootElement).innerHTML=marked.parse(e)}))},sendFile:e=>{let t=this.rootElement;if(l)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).innerHTML=`<img src="${e}" />`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n                    <img src="${e}" \n                    \n                    style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                     \n                    />\n                    `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n                    <embed src="${e}" \n                    \n                    style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n                     \n                    />\n                    `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let s=document.createElement("a");s.href=window.URL.createObjectURL(n.response),s.download=e,s.click()},n.send()}})}}))}}window.ReactRouter=ReactRouter;var i=0;let a={};window.getBundleSize=()=>{for(var e in a)i+=a[e].length;let t=document.documentElement.innerHTML.length,n=0,s=parseInt(i+t,10)||0;for(;s>=1024&&++n;)s/=1024;return`Bundle Size: ${s.toFixed(s>=10||n<1?0:1)} ${["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}`},window.onload=()=>{window.addEventListener("DOMContentLoaded",(()=>{"production"===document.querySelector("html").getAttribute("data-env")?(document.querySelectorAll("script[src]").forEach((e=>{const t=document.createElement("link");t.rel="preload",t.href=e.src,t.as="script",document.head.appendChild(t)})),document.querySelectorAll("img[src]").forEach((e=>{const t=new IntersectionObserver((n=>{if(n[0].isIntersecting){const n=e.dataset.src;n&&(e.src=n,e.removeAttribute("src"),t.disconnect(),console.log("Lazy loaded image: "+n))}}));t.observe(e)})),document.querySelectorAll('link[rel="stylesheet"]').forEach((e=>{const t=document.createElement("link");t.rel="preload",t.href=e.href,t.as="style",t.crossOrigin="anonymous",document.head.appendChild(t)}))):(console.warn("Not in production mode, skipping asset optimization."),console.log(getBundleSize()))}))},window.JsonWebToken={sign:(e,t,n="2h")=>{const s=new Date;s.setHours(s.getHours()+parseInt(n)),e.exp=s.getTime();const r=`${window.btoa(JSON.stringify(e))}.${window.btoa(t)}`;return localStorage.setItem("jwtToken",r),r},verify:(e,t)=>{const[n,s]=e.split("."),r=JSON.parse(window.atob(n));if(window.atob(s)===t)return r;throw new Error("Invalid token signature")},decode:e=>{const[t]=e.split(".");return JSON.parse(window.atob(t))},get:()=>localStorage.getItem("jwtToken"),remove:()=>{localStorage.removeItem("jwtToken")}};localStorage.getItem("jwtToken"),window.useState=React.useState;window.useEffect=React.useEffect,window.useContext=React.useContext,window.useReducer=React.useReducer,window.useRef=React.useRef,window.useCallback=React.useCallback,window.lazy=React.lazy,window.forwardRef=React.forwardRef,window.createContext=React.createContext,window.startTransition=React.startTransition,window.useSyncExternalStore=React.useSyncExternalStore,window.useMemo=React.useMemo,window.useLayoutEffect=React.useLayoutEffect,window.useInsertionEffect=React.useInsertionEffect,window.useImperativeHandle=React.useImperativeHandle,window.useId=React.useId,window.useDeferredValue=React.useDeferredValue,window.useTransition=React.useTransition,window.ReactRouter=ReactRouter,window.Lazy=new React.lazy,window.React=React,window.ReactDOM=ReactDOM,window.ReactRouter=ReactRouter,window.JsonHandler=t;let d=null;window.React._render=e=>t=>{const n=document.getElementById(t);d||(d=ReactDOM.createRoot(n)),d.render(e)},window.visiVersion="1.7.3-stable",fetch("https://registry.npmjs.org/visi.js").then((e=>e.json())).then((e=>{e["dist-tags"].latest!==visiVersion&&console.assert(!1,`You are using an outdated version of Visi.js. Please update to ${e["dist-tags"].latest} by running npm i visi.js@latest`,{current:visiVersion,latest:e["dist-tags"].latest})})).catch((e=>{console.error("Failed to check for updates. Error: "+e)}));const l=document.getElementsByTagName("head")[0];if(!l.querySelector('link[rel="icon"]')){const e=document.createElement("link");e.rel="icon",e.href="https://github.com/Postr-Inc/visi.js/blob/main/assets/visilogo.png?raw=true",l.appendChild(e)}let c=document.querySelector("html").getAttribute("data-render");window.CACHE_EXPIRATION_TIME=36e5;let h=localStorage.getItem("dispose_cache_version");window.CACHE_VERSION=h;window.updateCacheVersion=e=>{if(window.localStorage){const t=parseInt(localStorage.getItem("dispose_cache_version"));if(!isNaN(t)&&e>t){console.log("Clearing cache...");for(let e=localStorage.length-1;e>=0;e--){const t=localStorage.key(e);t&&t.startsWith("dispose_cache_")&&localStorage.removeItem(t)}localStorage.setItem("dispose_cache_version",e.toString()),window.CACHE_VERSION=e,console.log("Cache cleared.")}else console.log("Cache version is up to date")}};const u=new Worker(URL.createObjectURL(new Blob([`(${(()=>{onmessage=e=>{importScripts("https://unpkg.com/@babel/standalone/babel.min.js");const t=e.data,n=Babel.transform(t,{presets:["react","typescript"]}).code;postMessage({type:"code",data:n})}}).toString()})()`],{type:"application/javascript"})));window.dispose=(e,t,n={})=>{if("cfr"===c&&window.localStorage){const s=localStorage.getItem(e);if(s){const{type:e,data:r,componentName:o,timestamp:i,version:a}=JSON.parse(s);if(Math.floor(Date.now()/1e3)-i<window.CACHE_EXPIRATION_TIME&&a===h){if("tsx"===e||"jsx"===e){const e=new Function("props",`\n            return function() {\n              ${r}\n              return React.createElement(${o}, props)\n            }\n          `)(n);t(e)}else if("ts"===e){const e=new Function(r)()(n);t(e)}return}}}const s=e.split(".").pop(),r=["react"];fetch(e).then((e=>e.text())).then((o=>{const i=e.split("/").pop().split(".")[0];let d;if("ts"===s)d=`return (${o})`;else if(d=Babel.transform(o,{presets:r}).code,"cfr"==c&&window.localStorage){const t=Math.floor(Date.now()/1e3),n={type:s,data:d,componentName:i,timestamp:t,version:h};localStorage.setItem(e,JSON.stringify(n)),console.log("Saved to cache")}const l={type:s,data:d,componentName:i},m=new Function("props",`\n        return function() {\n          ${d}\n          return React.createElement(${i}, props)\n        }\n      `)(n);t(m),"ts"===s&&(a[e]=l,u.postMessage(o))})),u.onmessage=t=>{const{type:n,data:s}=t.data;"code"===n&&(a[e]={type:"ts",data:s,componentName:a[e].componentName})}};
